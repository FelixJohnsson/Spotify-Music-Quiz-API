<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Room test</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
</head>
<body>
    <button onclick="init_new_room()">Init new room</button>
    <button onclick="increment_room()">Increment room</button>
    <button onclick="pause_room()">Pause room</button>
    <button onclick="unpause_room()">Unpause room</button>
    <button onclick="add_player()">Add player</button>
    <button onclick="remove_player()">Remove player</button>
    <div id="room_output">

    </div>
</body>
<script>
    let token = 'BQAg1uJTDR75i734TI_GRumtRsWbWArwLCu-9--xZV2DhVVsXif2cUe987msJYnUfoDBVl6hPsB6A65sjjTRZ6O7iYJSMnA8QmJ-ejzJ2jd-eTmQD60CubfC8FwzicSEfHxtYYVCAE1Y301qs36JK1dzDlA4XM53HplM9zPZzlgzY7rtSjA8-7jA0OrOWRc3vHz1L8mTmagTSuZZim1uKI4rR6rclPZ8Yg8_qMsItnNW104XJLS2zeKjyH2EIpgjGYnlnO_z1EQnVBrKIXjL7Go';
    const init_new_room = () => {
        const body = {
            URI:'2Ob2rWWwZxbz6yWuTmBd6T',
            token: token,
            id:'felle21'
        }
        fetch('http://localhost:5000/init_new_room', {
                method: 'POST',
                headers: {
                    'content-type': 'application/json'
                },
                body: JSON.stringify(body)
            })
            .then(res => res.json())
            .then(data => {
                console.log(data)
                const div = document.getElementById('room_output');
                const p = document.createElement('p');
                p.style.fontSize = '20px';
                const id = document.createTextNode('Room number: ' + data.content.id);
                p.appendChild(id);
                div.appendChild(p);

                
                data.content.songs.forEach(object => {
                    const img = document.createElement('img');
                    img.src = object.track.album.images[0].url;
                    img.style.height = '100px';
                    div.appendChild(img);

                    const track_name_t = document.createTextNode('Song name: ' + object.track.name + ' by: ' + object.track.artists[0].name);
                    const track_name_p = document.createElement('p')
                    track_name_p.appendChild(track_name_t);
                    div.appendChild(track_name_p);
                })
            })
    }
    const increment_room = () => {
        const body = {
            token: token,
            id:'felle21',
            room_id: '1',
            type: 'Increment room',
            value: null
        }
        fetch('http://localhost:5000/update_room', {
                method: 'POST',
                headers: {
                    'content-type': 'application/json'
                },
                body: JSON.stringify(body)
            })
            .then(res => res.json())
            .then(data => {
                console.log(data);
            })
    }
    const pause_room = () => {
        const body = {
            token: token,
            id:'felle21',
            room_id: '1',
            type: 'Pause',
            value: 10000
        }
        fetch('http://localhost:5000/update_room', {
                method: 'POST',
                headers: {
                    'content-type': 'application/json'
                },
                body: JSON.stringify(body)
            })
            .then(res => res.json())
            .then(data => {
                console.log(data);
            })
    }
    const unpause_room = () => {
        const body = {
            token: token,
            id:'felle21',
            room_id: '1',
            type: 'Unpause',
            value: null
        }
        fetch('http://localhost:5000/update_room', {
                method: 'POST',
                headers: {
                    'content-type': 'application/json'
                },
                body: JSON.stringify(body)
            })
            .then(res => res.json())
            .then(data => {
                console.log(data);
            })
    }

    const add_player = () => {
        const body = {
            token: token,
            id:'felle21',
            room_id: '1',
            type: 'Unpause',
            value: null
        }
        fetch('http://localhost:5000/add_player', {
                method: 'POST',
                headers: {
                    'content-type': 'application/json'
                },
                body: JSON.stringify(body)
            })
            .then(res => res.json())
            .then(data => {
                console.log(data);
            })
    }

    const remove_player = () => {
        const body = {
            token: token,
            id:'felle21',
            room_id: '1',
            type: 'Unpause',
            value: null
        }
        fetch('http://localhost:5000/remove_player', {
                method: 'POST',
                headers: {
                    'content-type': 'application/json'
                },
                body: JSON.stringify(body)
            })
            .then(res => res.json())
            .then(data => {
                console.log(data);
            })
    }
</script>
</html>